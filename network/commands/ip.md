# IP command

## Commands

### Show NIC and its IP address

```
$ ip address
1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
    inet 127.0.0.1/8 scope host lo
       valid_lft forever preferred_lft forever
    inet6 ::1/128 scope host 
       valid_lft forever preferred_lft forever
2: ens33: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc fq_codel state UP group default qlen 1000
    link/ether 00:0c:29:f2:b0:16 brd ff:ff:ff:ff:ff:ff
    altname enp2s1
    inet 192.168.87.129/24 brd 192.168.87.255 scope global dynamic noprefixroute ens33
       valid_lft 1559sec preferred_lft 1559sec
    inet6 fe80::f7ba:145c:1cfe:7954/64 scope link noprefixroute 
       valid_lft forever preferred_lft forever
3: docker0: <NO-CARRIER,BROADCAST,MULTICAST,UP> mtu 1500 qdisc noqueue state DOWN group default 
    link/ether 02:42:f5:5e:f2:2a brd ff:ff:ff:ff:ff:ff
    inet 172.17.0.1/16 brd 172.17.255.255 scope global docker0
       valid_lft forever preferred_lft forever
```

- network interface cards (NIC)
  - lo: Loopback network interface
  - ens33: Ethernet (en) + hotplug slog number (s33)
- mtu 65536: Max transmission unit = 65536
  - packet size
- link/XXX: MAC address

### Show routes

```
$ ip route
default via 192.168.87.2 dev ens33 proto dhcp metric 100 
169.254.0.0/16 dev ens33 scope link metric 1000 
172.17.0.0/16 dev docker0 proto kernel scope link src 172.17.0.1 linkdown 
192.168.87.0/24 dev ens33 proto kernel scope link src 192.168.87.129 metric 100
```

- `ip route` shows default table named "main".
  - `ip route show table <tablename>`
  - `ip route show table all`
- Private IPs
   - 169.254.0.0/16 is link local address.
   - 172.16.0.0/12 is class B private IP address
   - 192.168.87.0/24 is class C private IP address
- proto kernel
   - generated by kernel
- proto dhcp
   - Generated by Dynamic Host Configuration Protocol?

### Show priority which ip table to use

```
$ ip rule
0:	from all lookup local
32766:	from all lookup main
32767:	from all lookup default
```


## Reference

- Predictable Network inteface name: https://www.freedesktop.org/wiki/Software/systemd/PredictableNetworkInterfaceNames/
- http://linux-ip.net/html/
- About IP command: https://qiita.com/testnin2/items/7490ff01a4fe1c7ad61f
